/*
Do Not Disturb on Navigator Home Page v0.1
Purpose: Places a Do Not Disturb button on the home page of the Navigator and shows current status.  Note: Do Not Disturb can also be accessed by clicking the upper left corner button of any device.   

This macro will not work properly with personal devices if the end user has Quiet Hours turned on. 

let author = "joehughe" + "@" + "cisco.com"

License: MIT LICENSE 
for more details see: https://github.com/vtjoeh
*/

import xapi from 'xapi';

const PANEL_ORDER = 1; // Lower number means the DND button appears first on the touchpanel ahead of other custom buttons.  Built-in buttons appear ahead of all custom buttons. 

const TEXT_DND_ON = 'Do Not Disturb: On'; // Text shown under icon when DND turned on

const TEXT_DND_OFF = 'Do Not Disturb: Off'; // Text shown under icon when DND turned off 

const DO_NOT_DISTURB_MIN = 540 // in minutes. How long DND is turned on. 

const PANEL_ID = 'panel_do_not_disturb';

const ICON_ID_GREEN = 'IconIdDoNotDisturbGreen';

const ICON_ID_RED = 'IconIdDoNotDisturbRed';

let statusDnD = '';

upLoadPanelButton(); 

function updateStatus(dndEvent) {
  if (dndEvent === 'Active') {
    statusDnD = 'Active';
    xapi.Command.UserInterface.Extensions.Panel.Update({ Name: TEXT_DND_ON, PanelId: PANEL_ID, IconId: ICON_ID_RED, ICON: 'Custom'});
  }
  else if (dndEvent === 'Inactive') {
    statusDnD = 'Inactive';
    xapi.Command.UserInterface.Extensions.Panel.Update({ Name: TEXT_DND_OFF, PanelId: PANEL_ID, IconId: ICON_ID_GREEN, ICON: 'Custom' });
  }
}

xapi.Event.UserInterface.Extensions.Panel.Clicked.on(panel => {
  if (panel.PanelId === PANEL_ID) {
    if (statusDnD === 'Active') {
      xapi.Command.Conference.DoNotDisturb.Deactivate();
    } else {
      xapi.Command.Conference.DoNotDisturb.Activate({ Timeout: DO_NOT_DISTURB_MIN });
    };
  }
});

async function upLoadPanelButton() {

  const ICON_DND_OFF_GREEN = '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';

  const ICON_DND_ON_RED = 'iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAYAAAA+s9J6AAAAAXNSR0IArs4c6QAAFh5JREFUeF7tnWtsXMd1x89y+TBp6mHJMqW1RZOBABlQg9RCGsJABdlVG8WpYzmF5Bau4YZwgTo0IH2SBKlCDAe0Bcmf6MKsvhiMidYGIqaQbMMKgwi2oQAKE1RK4row2zRaS/ZKih6mKYkSL7mc4szuXe5Su3sfe+fuzL1/fnAM771zZ/5zfpmZM2fOJAh/UAAK1FWBRF2/jo9LBa4OHRAzmQxlP/+EspfTlD0/TnNXc+IkmvMieekpkXtHWPMCNywjSq5aS8mVD1Cyo4saly6i5c/3eykVvaVIAXSCImHLFXvltX1ievwjyl74hGbPjZOYJEq0EFEjESXz0PG/NxTTF1AFmci5PJyzRJQlIv5fBraJKLkyRQ3L11JTZxd1vDgEuwhIdjfFQGw3Kvl8JrN9i7B+d4zElEU0kzN2hi2hCjSf9ZSvZXPDpmAwp/MFtZAcNVu+9gjArEVbh3cBYYDiXti1Vdz8+QiJ6fwI16IpcG7bnB89bTC5XQ13E7X8+bO06qXXYTtudQSEASlVppjLA3vErV+P0szHp4jYJBk6XsMVFnLqvl23krNWyWjZ9LVHqG3jo7Tse7sApc9OgXAehWPwpt5/i7Jn03ItJ9d0Sdt74rEw0x+3R0qevs4SNa5ZS20bt8Hh47FfAaELwdh7ef3wfsqen5DruliDV00vHiUZyBmi5OoUtX93By3r3Q0bw3TUBWUVHmHHyvSJowDPj4RFQLZs2EKpV48Cxgo6Qpgywpx9oktkP00T3cGjXkynmn7Aq/COmLaIbhEl7++i9i3fx+i4QCdAmBfkjy/3ianRQRLXiBJ3xnidFyB8txWVHx15Ot/2aB/ds3cQ9sd+PJWam1D2xR88I278ZJgSi/PbCXF1soTZWcKS0TwcrND211tp5cGRWNthbBtv7+nJbQVMOcNEsORb9lQ1zuvG2EF48YVeMXVsKBe5AvjqBt/CD0sYs0Rt33qGOn44HCu7jE1jL72yQ1w/PJCDL+ob6tqg5bEi+Wlq3GCMBYTpDSRkKFlrxKNZPNq8to8zjDdzcbZL/ulg5KNxIg3hZ0+vFzP/fQreTm1pc6gYe1Nv5CJxVv94PLK2GsmGXXr5OXH9yCFEtpgK38J652Fseyya68XIQZjeSIKnMph6RoXA+Xaw84aPgXWdiNbWWmQg5P2+qXeGKdGOjfbo4VfUIh4VrxO1/lV09hcjAeHZby8V2csTlGhDiFmkASxqHI+KybuWUud7E8bbsNENkGu/kUNwvMSFvEprxe/0Gn3y31gIzz25Vsz+fpwSizH6xZVBu92cPoRz5HS+nTHSno2sNO/7yQ5AnGfc+Ztvf/7Ef/dJ85w2RkEoo17eGsD0E+iVVyC/ldG+9TlasfeQMbZtTEUzfZvE9C+PY/oJAB0V4Olp87oeundozAj7NqKS0vv5xQQCrh3NDw8U1om8p9hM1PWh/tNT7SE88xAJmacT6z8Q5lUBQ9aJWkN45hskkFTJq+Xh+RIF8qf5l/TpGwiuJYTSAfPmgDztHukcnuAlHAX4VMYkUfs2PR022kFY2IDH/l84Bhqjr4hJi3QMAtcKQnnq/Z0heEBjBEbYTdURRG0glAHY73LCJUTAhG2Ycfseb2G0PqxPALgWEGb6NovpX44CwLjRUMf2MogtX99EqcHjdWeg7hXACFhHS4z5p3UZEesKIZwwMadAg+YziPXO8FY3CDnj9Y2RQUxBNTDEuFeh3s6aukBYCMSGEybu9q9N+xnEegV+1wXCMw+SSCyBF1QbC0RFpALiS4uWbD8Q+oU1oUMoQ9GQ/xNmr6MC+Xyn3b8KN+g7VAgRjK2j5aFO5WJNwwQxNAj5ONLctQmchoDN669A1iJqCO8YVCgQft7bI6xPxnAeUH/zQw3zCnA2t8bV4WT+Vg5hIRs20hHCwA1TIKw9ROUQnllPAvGghlkfqltQgLculmxXexZRKYRwxMCajVcgBI+pMgjhiDHe/NAAWwHFjholEMqrqD8YQVp6mHFkFGBHTcufbaHUq0cDZybwAll1rAMjY3toSJECvD7sPhX8Rn7gEPLVZDSH7Giw3ggqoGhaGiiEMkHv6ePYD4yg/aFJOQV4Wtr8QLCJhQOFEIHZMNU4KBB0oHdgEMrtCD4YIf+BPygQYQUC3rYIBELpDT0xgmlohO0OTStVQHpLH9xMqcHRmhmquQB4Q2GecVUgKG9pzRCefTwl5r7I4HREXC0xzu0OyFtaE4RXXtsnJl/vR56YOBtizNvOQd7t23bQip0Dvlny/aKchuKUfMxNEM0ndtJco5o28X1DCGcMDBAKzO8d1uKk8Q0hQtNgglBgXoFanDS+IJRp60+PYksCVggFbAWyFjV299B9w96v6PYFIUZB2B4UuF0Bv6OhZwgRHwrzgwIVFPA5GnqGEPGhMEEoUFkBjivtPu3tuJMnCDlr2szvx7AxDyuEApUUyFqUXOUtS5snCP+wjkTDCgRowwKhQDUF5i5Z9JWP3Y+GriHEviAMDwq4VCBrUfNX3Qd3u4YQR5VcdgAegwIejzq5gvDywB5x7d/3I3ETzAsKuFSAjzrd+Z0+umfvoCNjjg/wN5E3xqXyeAwK2ArwaGgRdZ90Xhu6ghCb87AtKOBdAbeb944QYlvCu/h4AwpIBVxuVzhCiG0JGBQU8K+Am+2KqhDKu+UPD8Ah478P8GbMFWAHTds3e6njxaGKrFWFML2BhNQwiQ36mNsSmu9XARfbFVUhRJyoX+XxHhSYV8DJQVMRwosv9Iqpnw3hzCCsCQrUqABPSVs3bKWVB0fK8lYRQmRRq1F5vA4FbAU4K1uymbo+sLxBiL1B2BAUCE6BakecypIJr2hw4qMkKMAKVPOSloXw7BNdYu5KGl5R2A8UCEqBKlPSshBigz4o5VEOFCjyklY4dV8WQqwHYTpQIHgFOFv3kr6DtOx7u0q4uw3CzPYtwjp9FFPR4PsAJcZdgaxFTWtuv2D0NgjlBv1i3DMYd3tB+9UoUC6W9DYIsR5UIz5KhQLSS1pmXXj7SLieR0LEisJkoIAKBeS68PsHaFnv7gJ7JRByenvro1GsB1WojzKhACtQZl1YAmH64WbBD+HUBOwFCihSgHNezBF1nZhPe1ECIe4bVCQ8ioUCRQosPFVRCiF7RpdgPQiLgQIqFagIobz6+o1+o0/R86KXZlXKh7K1UKCRzLbTBekQCyOh6Rm2OUB28dP7aPnz/Y55c7QwJFTCtwJywPi3fmPPurKtFt/sWzDYz55eL2Y/PWWsU8bp9LLvHseLWipgdGhl1qKG5V3UeSQt+StAKBP8yv9i5poQEGrJirJKGQ3hgrwzBQhNzycDCJXZu5YFGw3hgsgZQKiliaFSTgoYD+GkRd2ncjPReQi/QSLRZuZUlBuCkdDJbKP1u/EQFoWvSQijcOsSIIwWZE6tMR5CTgr82A7q+OeBhITw/M6nxK1fvGmsyxcjoZPJRu/3KEBob1NICE3fngCE0YPMqUWmQ8gx2g13pajz7UxuJDR9ewIQOpls9H43HsIiP4aE0PTtCUAYPcicWhQFCO1T9hLCKJymh2PGyWyj9Tsg1LA/AaGGnaKwSpGDENNRhdaCopUoEAUI7XwzWBMqMREUqlqBSECYj5oBhKqtBeUrUSB6EEYgwxrWhEpsXdtCAaGGXQMINewUhVUChArF9Vs0IPSrnJnvAUIN+w0QatgpCqsUCQinLOr+FeXC1iLRoKLzWQr7HkVrokAkbBYQamJNqIYvBQChL9nUvoTpqFp9dSsdEOrWIzhZr2GPqK1SJCAs2azHPqFai0HpgSsQPQgjkP4e09HA7VzrAgGhht0DCDXsFIVVAoQKxfVbNCD0q5yZ70UCwvytvTjUa6YNxr7WgFBDE8BIqGGnKKxSFCBEeguFBoKi1SsQOQjPPERC3gNj6GUw3OUYCdUbvk5fiByEZx9PibkvMsZeiwYIdcIjnLoYD2HWImog6vowH8Cd2b5FWKePAsJw7AdfCUCBKEDY2N1D9w2P5U5RXHxph5h6dwBp8AMwDhQRjgKmQ8i39d7xF8/Sqpdez0F4deiA+PJfd5t9DziOMoVj/Zp8xXgIpyxa/A+5693nr0YzPH4UjhlN6AipGsZDWPZ+QsPjRwFhSNavyWeMhzAfLcNyll4S2mruNgUg1ISOkKphPITlRsKzT3SJuStpYz2kgDAk69fkM0ZDyNeiLVpKne9NlF6XnenbLKZPjxrrIRX5fB2a2AiqoViBMyZf7561qHHNI3Tf0PulEP7x5T5x451BYyEkYSnudhSvnQKGRnjx9kTbN3up48WhUghZYKOHeBk2AxC1A0VVhQwFsFx0V8ExEwkIVXU4yoUCASpg38ZkF1kCYXoDCY5nMzmQO0CtUBQUCF4BYckJW/fJ+Z2JEgg/e3q9mP30lLEe0uAVQ4lQIGAF2DO6vIs6j6QL7JVAeOW1fWLyjX6jw9cClgzFQYFAFWCnTPvf7KAVOwfKQyjXhYZHzgSqGAqDAgErsHA9yMWXjIT8H/6wjkTDCj7hiz8oAAWCVsBOaVFc7m0QnntyrcieH8e6MGj1UR4UWBApU9Y7yv8xCsea0NtQQEcFOKpr0d/vobt37C8Z/G4bCbEu1LH7UKcoKFBuPVh2Tcj/Mb2RBM0RpqRR6Hm0QQ8FeH/wJslLQRdWqOxIeH7nU+LWL940N45UD9lRCygwr0DWouYHt1Dq1aPuIJRTUsNP2qP/oYBOClQ7ald2JCxMSeWEFdsVOnUm6mKgAmVC1apuUdg/8vlC66NRrAsN7HNUWTMF+PxgPr1huZpVHAkxJdWsI1EdYxVwyvrgDOEiTEmN7X1UXAsFKm1N2JWrCiFn5p7+9VF4SbXoSlTCSAWyFjWt6aF7h8YqslYVQjklRUC3kX2PSuuhgNMoKH2fTlU9++2lYu7aBBw0TkLhdyiwUIGiS1+qieMIIc4YwraggD8FOFa0fVvp2UHP3lH7BZlezuDEwP4kxFtQoDYF3ExFXU1H+aELu7aKmydG4KCprU/wdowU4BP0LQ9uptTgqONs0/GBwmiIMLYYmRCaWqsCTnuDxeW7hhBJoGrtFrwfGwXKJHOqyTFT/DK2K2JjRmhoDQp4GQVdrwnt+uCcYQ09g1fjoQBvSxBR1wnn7T9bENfTUawN42FDaGVtCngdBT2PhPwCNu9r6yS8HWEFKiRycmqx55GQC8SBXydZ8XscFfAzCvoaCeVoaPiFonE0ELRZsQI8Ct6Vos63M54HNs8vYG2ouDNRvJEK+B0FfY+EGA2NtBNUWpUCPteCvr2jxe3AvqGqXkW5JingNka0Upt8T0e5QMSUmmQqqKsKBXIxopsoNXjcN0u+XyysDR8iIROyISubij5GmTorUCWhr5dq1wyhPG/4ej8lFiM1ohfh8az5Crg9L+jU0poh5A/gJicnmfF75BSoYUtioRaBQMiFwkkTOTNDg6ooUKszprjowCC8+INnxNRPh3HVNkw38gqwM6Z1w1ZaeXAkEH4CKcRWHXGlkbc/NNBl8iYvQgUKoZyWIh+NF/3xrGEKsDOm3PVmtTQjcAgvvbJDXD88gGlpLb2Cd7VUgAFse7SXOl4cCpSbQAuzlYO3VEsbQqVqUSBAb6gy7+jCguVxJ9xjUUu3411dFOBN+Umi7tPuT8t7qbqSkdCuAM4deukKPKurAnxCYvGz+2j58/1KeFFSqC3mxRd6xdSxIawPdbUu1MtRAV4Htj4c3HZEuQ8qhZA/yKkSZ/7vFBIHO3Y3HtBOgaxFyVVrafWPx5VyorRwW1RkadPOvFAhJwV8ZE1zKrLS76FAyB+Ho8ZvF+G90BVgR8w1ou5TahwxoXlHywkHR03o5oQP+lBAtSOmrhBeHtgjrr2xH8eefBgGXglHAXbE3PlEH92zdzC0WWJoHyp4TDnQ+91hgBiOTeErHhQIwxNaF+9ouY9+3tsjrI/HsHXhwUDwqFoF+GRE42r1nlBtIOSKYOtCrVGhdPcKMIDJji7qPJIOfWbItazLR215AKJ7Q8GTahSoN4B1h5ArwNm8sxfT2MxXY2MotZoCNeYLDUrcuo6EdiP4MHD2iwmAGFSvohxnBRQcznX+aPkntIBQjoiPp0T2UgYg+u1JvOdeAU1GQLvC2kDIFeJziLPnxgGie3PCkx4V0GENuLDKWkEIED1aFB73pICOAGrhmCmnohwR0+PYR/RkYni4mgK8EZ9M1W8bolrdtBsJ7crKey4+GAGIYKtmBRjAlq9vptTgqJb2rmWlbNVl0qi3BghpMmq2w9gWwMHY7VufoxV7D2lr69pWzLaaq0MHxJf/spsSdxJREvddxJYmrw3PWiRukNK0FF6rVOl57SG0K57eQEL+O0AMqu+jWw4DOEvUfbK+EWFuBTYGQm6QDHP7n1NYJ7rt3Rg+x+u/xq76BGL7ldsoCLmR8s4LPgqFdIp++zya7+VPw7f+pdqkTCrEMw5CFuHqjw6KL1/dhXWiCoswsUyefl4nWvyP6tISqpTFSAhtQWTwdyZNiVbcFKzSSHQuW+7/3b2UOt+bMNaWja14YRvj5efE9SOHKNECp43OsARet7z3s+2xZ6jjh8NG27HRlS/uWE6rKCxC3Gng1q5fgRx+lmgk6jphhvfTScHIQMgNzWzfIqZPHKVEO0ZFp4438vf82q/loU2UGjweGduNTEOKjUoei7qQwVrRSNLKVzoKa79K3RFJCLmxdsgbtWCKajSL+bWf7qFntWgcWQhtUTJ9m8T0yeOYotZiJfV4Nz/1bP7THrp3aCzSdhrpxpVMUTmFxoUJ7C3WAygv32T4pkkuJbo+jIbjxan5sYFQbvIPHRDXD+8nwOhkFnX4nSNebubgW/SkmZvuflWLFYS2SAzj5I92y0s/EP7m13QCes+Gr4Vo0d/FCz5bwVhCaDf+ymv7xOQb/USzhGlqQEy5LiY/7WTtVd6C67o+dXww1hAWj4z2NBXeVMXWmPd2JlcupfZte2hZ7+7Y22DsBVhocp/1PiJmfvM+0R1ECT5DLP+Bv5oU4CmnRUS3iJq+2kP3DUfb2+lVK0BYQbGLL/SKqWNDmKp6taji5/OjHjUStX3L/BjPWqSo9i4gdKGszP72v+NETbzxj5C4qpLZa70ZouT9emY3c9HloT4CCD3IzY6cqQ8PE6dj5D8AmRevyMnSuGYttW3cRsuf74dtubQtCOVSqIWP8TbH1Pv/QdZ/juVg5PC4uKwh7TXeNBFn/mlat57aNv0tnCw+bQkQ+hRu4Wsy7cZPh2WGrwKUjUTUEAHnDl+ewrxNU6F9d2x6ila98ibsJwD7gYgBiFiuCD5WZf3uGHH0P++FsXNCwsl/uoLJLsw5kpnK5B+PdFzvVqLmdfomz1XUhaEVCwhDkppPdcycS9Ps2d8S38fI7noZGcmjZZLkIVX5F0ZKR3tkY9iylPs/CU4o2UQyVXxjai01dT9AK3YOwD5CsA+IHILI1T7Bzh4rc56y5/6LZj8dIzFJck+tsD1p95ANqZf62iNaLmNrbq+OB+K7iRrv76Hk6j+h5tQqOFG8aKrgWUCoQFQUCQW8KPD/XiLKWlIQ6w0AAAAASUVORK5CYII='

  let PANEL_XML = `<Extensions>
    <Panel>
      <PanelId>${PANEL_ID}</PanelId>
      <Order>${PANEL_ORDER}</Order>
      <Location>HomeScreen</Location>
      <Icon>Custom</Icon>
      <Name>${TEXT_DND_OFF}</Name>
      <ActivityType>Custom</ActivityType>
      <CustomIcon>
        <Content>${ICON_DND_OFF_GREEN}</Content>
        <Id>${ICON_ID_GREEN}</Id>
      </CustomIcon> 
    </Panel>
  </Extensions>`; 

  await xapi.Command.UserInterface.Extensions.Icon.Upload({ Id: ICON_ID_GREEN}, ICON_DND_OFF_GREEN);

  await xapi.Command.UserInterface.Extensions.Icon.Upload({ Id: ICON_ID_RED }, ICON_DND_ON_RED); 

  await xapi.Command.UserInterface.Extensions.Panel.Save({PanelId: PANEL_ID}, PANEL_XML); 

  await xapi.Status.Conference.DoNotDisturb.get().then(updateStatus); 
}

xapi.Status.Conference.DoNotDisturb.on(updateStatus);



